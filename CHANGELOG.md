# 更新日志 (Changelog)

## [v1.2.0] - 2025-10-17

### 🔥 重大修复
- **修复元素选择器提示框遮挡问题**
  - 提示框从屏幕中央移至顶部 (`top: 80px`)
  - 添加 `pointer-events: none` 让鼠标可以穿透提示框
  - 所有提示现在会在 2 秒后自动消失
  - 大幅提升选择器配置体验，不再被提示框阻挡

### ✨ 新增功能
- **配置面板可拖拽**
  - 可以拖动配置面板标题栏到任意位置
  - 自动限制在视口内，不会拖出屏幕
  
- **配置面板最小化**
  - 新增最小化按钮 (`−`)
  - 最小化后变成 60x60 圆形浮球（🎯图标）
  - 双击圆形浮球可重新展开面板

### 🛠️ 优化改进
- **智能选择器生成** (element-picker.js)
  - 生成多个候选选择器并验证唯一性
  - 优先使用 ID、语义化属性 (data-testid, aria-label 等)
  - 过滤动态 class 名称 (ng-*, mat-*, mdc-*, 随机数字等)
  - 避免使用不稳定的 `nth-child` 选择器
  - 对不唯一的选择器发出警告

- **配置键名标准化** (selector-config.js)
  - 统一使用基于 hostname 的配置键 (如 `chatgpt_com`)
  - 自动规范化旧格式配置 ('ChatGPT' → 'chatgpt_com')
  - 确保配置显示和匹配的一致性

- **标签页选择优化** (selector-config.js)
  - 仅查询当前窗口的标签页
  - 按 hostname 去重，避免重复显示
  - 提升配置列表清晰度

### 🐛 Bug 修复
- 修复 Gemini 配置后无法发送消息的问题
- 修复配置状态显示不一致（已配置但显示未配置）
- 修复选择发送按钮时误触发按钮点击的问题
- 修复提示框动画从 fadeIn 改为 slideDown 以适配新位置

### 📝 文档更新
- 新增 `元素选择面板改进说明.md` - 详细说明提示框优化和拖拽功能
- 新增 `智能选择器生成-改进说明.md` - 说明选择器生成逻辑
- 新增 `修复发送按钮错误-图文教程.md` - 快速修复配置问题的指南
- 新增 `诊断配置状态.js` - 用于诊断配置的控制台脚本
- 新增 `快速修复发送按钮.js` - 快速修复常见 AI 站点配置的脚本

### 🔧 技术改进
- CSS: 提示框样式优化，减小体积，改善视觉效果
- JavaScript: 完善事件阻止机制，确保选择过程不触发页面事件
- 代码质量: 增强错误处理和调试日志

### 🎯 影响范围
此次更新主要影响：
- `selector-config/element-picker.css` - 提示框和面板样式
- `selector-config/element-picker.js` - 选择器生成和面板交互
- `selector-config/selector-config.js` - 配置管理和显示逻辑
- 新增多个辅助工具和文档文件

---

## [v1.1.0] - 2025-10-15

### 🚀 突破性更新
- **完全移除硬编码**
  - 不再预设 AI 网站列表
  - 从已打开标签页动态选择网站
  - 支持用户添加任意 AI 网站

- **通用内容脚本注入**
  - `manifest.json` 的 `content_scripts.matches` 改为 `<all_urls>`
  - 支持任意网站的 iframe 通信
  - 不再局限于特定域名

### ✨ 核心功能
- 标签页选择器 (tab-selector)
- 分屏视图 (split-view)
- 选择器配置向导 (selector-config)
- 统一输入和发送功能
- 可视化元素选择工具 (element-picker)

### 🛠️ 技术架构
- 使用 declarativeNetRequest API 移除 X-Frame-Options
- postMessage 跨 iframe 通信
- chrome.storage.local/sync 数据持久化
- 动态选择器配置

---

## 版本说明

- **v1.2.0**: 元素选择体验优化和选择器智能化
- **v1.1.0**: 完全动态化，移除硬编码
- **v1.0.0**: 初始版本

---

**更新时间**: 2025-10-17  
**项目**: 多AI对话聚合器 Chrome 扩展

