# 预设配置功能说明

## 功能概述

实现了预设配置与用户配置分离的系统，让主流AI网站**开箱即用**，同时保持用户**完全可定制**。

## 核心特性

### 1. 开箱即用 🎉
无需配置即可使用以下AI网站：
- ✅ **DeepSeek** - chat.deepseek.com
- ✅ **ChatGPT** - chatgpt.com
- ✅ **Gemini** - gemini.google.com
- ✅ **Claude** - claude.ai
- ✅ **通义千问** - tongyi.aliyun.com
- ✅ **文心一言** - yiyan.baidu.com
- ✅ **Kimi** - kimi.moonshot.cn
- ✅ **豆包** - doubao.com
- ✅ **Poe** - poe.com
- ✅ **Perplexity** - perplexity.ai
- ✅ **You.com** - you.com
- ✅ **HuggingChat** - huggingface.co

### 2. 配置来源清晰标识 🏷️

#### 在选择网站时
- **✓ 使用预设** - 蓝色标识，表示使用插件预设配置
- **✓ 已自定义** - 绿色标识，表示用户自定义配置
- **待配置** - 黄色标识，需要用户配置

#### 在已配置列表中
每个配置旁边显示来源徽章：
- **⚙️ 预设** - 蓝色徽章
- **✏️ 自定义** - 绿色徽章

### 3. 用户配置优先 👑
- 用户自定义配置**始终优先**于预设配置
- 用户配置**永不丢失**，不会被插件更新覆盖
- 完全尊重用户的选择

### 4. 重置为预设 🔄
- 有预设配置的网站显示"🔄 重置"按钮
- 点击后删除用户配置，恢复使用预设
- 适用于：配置错误想重新开始、想使用最新预设等场景

### 5. 易于维护 🛠️
- 所有预设配置集中在 `default-configs.js` 文件
- 只需编辑该文件即可添加/更新预设
- 文件格式简单清晰，易于维护

## 技术实现

### 动态合并机制
```
运行时加载配置的优先级：
1. 用户自定义配置 (chrome.storage.local)
2. 预设配置 (default-configs.js)  
3. 通用选择器 (兜底策略)
```

### 文件结构
```
├── default-configs.js           # 预设配置文件（新增）
├── content-scripts/
│   └── iframe-injector.js       # 加载配置逻辑（已修改）
├── selector-config/
│   ├── selector-config.js       # 配置界面逻辑（已修改）
│   ├── selector-config.html     # 配置界面HTML（已修改）
│   └── selector-config.css      # 配置界面样式（已修改）
├── manifest.json                # 引入预设配置（已修改）
└── 预设配置长期优化计划.md       # 未来改进计划（新增）
```

## 使用方法

### 对于新用户
1. 安装插件
2. 打开主流AI网站（如DeepSeek、ChatGPT等）
3. 直接使用，无需任何配置！

### 对于老用户
- 已有配置保持不变
- 配置界面会显示"✏️ 自定义"标识
- 可以选择"重置为预设"使用新的预设配置

### 添加新网站
1. 点击插件图标 → "配置选择器"
2. 选择新网站
3. 按照向导标记输入框和发送按钮
4. 保存后自动成为用户自定义配置

### 更新预设配置
只需编辑 `default-configs.js` 文件：

```javascript
const DEFAULT_CONFIGS = {
  'new_ai_site_com': {
    name: '新AI网站',
    inputSelector: 'textarea.input',
    sendButtonSelector: 'button.send',
    version: '2025-01-19',
    notes: '适用于新AI网站'
  }
};
```

## 视觉效果

### 配置状态颜色
- 🟢 **绿色** - 用户自定义配置
- 🔵 **蓝色** - 使用预设配置
- 🟡 **黄色** - 待配置

### 按钮图标
- ✏️ **编辑** - 重新配置
- 🔄 **重置** - 恢复预设（仅用户配置显示）
- 🗑️ **删除** - 删除配置

## 常见问题

### Q: 预设配置会覆盖我的自定义配置吗？
A: **不会**。用户自定义配置始终优先，插件更新不会覆盖用户配置。

### Q: 如何使用最新的预设配置？
A: 如果你之前自定义了配置，点击"🔄 重置"按钮即可恢复使用预设。

### Q: 预设配置不好用怎么办？
A: 可以自己重新配置，你的配置会自动覆盖预设。

### Q: 预设里没有我用的AI网站怎么办？
A: 使用"配置选择器"手动配置即可，功能完全一样。

### Q: 如何查看当前用的是预设还是自定义？
A: 在配置页面，每个网站旁边都有清晰的标识。

## 未来改进

详见 `预设配置长期优化计划.md`，包括：
- 版本比较与更新通知
- 字段级合并（部分用用户的，部分用预设的）
- 智能配置验证
- 云端配置同步

## 技术支持

如需添加新的预设配置或遇到问题，请：
1. 检查 `default-configs.js` 文件
2. 查看控制台日志（是否成功加载预设配置）
3. 确认 manifest.json 正确引入了 default-configs.js

---

**版本**: 1.0  
**发布日期**: 2025-01-19  
**兼容性**: Chrome Extension Manifest V3

