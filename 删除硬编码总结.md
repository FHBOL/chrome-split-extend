# ğŸ¯ åˆ é™¤æ‰€æœ‰ç¡¬ç¼–ç AIç½‘ç«™ - å®Œæ•´æ”¹é€ 

## ğŸ“‹ æ”¹é€ ç›®æ ‡

å½»åº•åˆ é™¤æ‰€æœ‰ç¡¬ç¼–ç çš„AIç½‘ç«™åˆ—è¡¨ï¼Œæ”¹ä¸ºå®Œå…¨åŠ¨æ€çš„ä»æ ‡ç­¾é¡µé€‰æ‹©æœºåˆ¶ã€‚

## âœ… å·²ä¿®æ”¹çš„æ–‡ä»¶

### 1. æ ¸å¿ƒé…ç½®æ–‡ä»¶

#### `config.js`
**ä¿®æ”¹å‰**ï¼š
```javascript
const DEFAULT_AI_SITES = [
  { id: 'chatgpt', name: 'ChatGPT', url: 'https://chatgpt.com/', ... },
  { id: 'gemini', name: 'Gemini', url: 'https://gemini.google.com/', ... },
  { id: 'claude', name: 'Claude', url: 'https://claude.ai/', ... }
];
```

**ä¿®æ”¹å**ï¼š
```javascript
// AIç½‘ç«™é…ç½® - ä¸å†ç¡¬ç¼–ç ï¼Œæ”¹ä¸ºä»æ ‡ç­¾é¡µåŠ¨æ€è·å–
const DEFAULT_AI_SITES = [];
```

### 2. åˆ†å±è§†å›¾

#### `split-view/split-view.js`
**ä¿®æ”¹**ï¼š
- âœ… åˆ é™¤`getDefaultSites()`ä¸­çš„ç¡¬ç¼–ç åˆ—è¡¨ï¼Œè¿”å›ç©ºæ•°ç»„
- âœ… ä¿®æ”¹`loadConfig()`ï¼Œä¼˜å…ˆä»`tab-selector`ä¼ é€’çš„æ•°æ®åŠ è½½
- âœ… æ·»åŠ æ—¶é—´æˆ³æ£€æŸ¥ï¼Œç¡®ä¿æ•°æ®æ˜¯æœ€è¿‘ä¼ é€’çš„

**å…³é”®ä»£ç **ï¼š
```javascript
async function loadConfig() {
  return new Promise((resolve) => {
    // ä¼˜å…ˆä»tab-selectorä¼ é€’çš„æ•°æ®åŠ è½½
    chrome.storage.local.get(['selectedSitesForSplit', 'splitViewTimestamp'], (localResult) => {
      if (localResult.selectedSitesForSplit && 
          localResult.splitViewTimestamp && 
          (Date.now() - localResult.splitViewTimestamp < 5000)) {
        aiSites = localResult.selectedSitesForSplit;
        chrome.storage.local.remove(['selectedSitesForSplit', 'splitViewTimestamp']);
        resolve();
      } else {
        chrome.storage.sync.get(['aiSites'], (result) => {
          aiSites = (result.aiSites || []).filter(site => site.enabled);
          resolve();
        });
      }
    });
  });
}
```

### 3. å†…å®¹è„šæœ¬

#### `content-scripts/injector.js`
**ä¿®æ”¹**ï¼š
- âœ… åˆ é™¤`getDefaultSites()`ä¸­çš„ç¡¬ç¼–ç ï¼Œè¿”å›ç©ºæ•°ç»„

### 4. ä¸»æ§åˆ¶é¢æ¿

#### `main/main.js`
**ä¿®æ”¹**ï¼š
- âœ… `loadConfig()`ï¼šä¸å†ä½¿ç”¨`DEFAULT_AI_SITES`ï¼Œç›´æ¥è¿”å›ç©ºæ•°ç»„
- âœ… `resetConfig()`ï¼šæ”¹ä¸ºæ¸…ç©ºæ‰€æœ‰é…ç½®ï¼Œè€Œä¸æ˜¯æ¢å¤é»˜è®¤

**ä¿®æ”¹å‰**ï¼š
```javascript
function resetConfig() {
  aiSites = JSON.parse(JSON.stringify(DEFAULT_AI_SITES));
}
```

**ä¿®æ”¹å**ï¼š
```javascript
function resetConfig() {
  if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰é…ç½®å—ï¼Ÿä½ å°†éœ€è¦é‡æ–°ä»æ ‡ç­¾é¡µé€‰æ‹©ç½‘ç«™ã€‚')) {
    aiSites = [];
    saveConfig();
  }
}
```

### 5. å¼¹å‡ºçª—å£

#### `popup/popup.html`
**ä¿®æ”¹**ï¼š
- âœ… ä¸»æŒ‰é’®æ”¹ä¸º"ä»æ ‡ç­¾é¡µé€‰æ‹©å¹¶åˆ†å±"
- âœ… æ›´æ–°è¯´æ˜æ–‡å­—

**ä¿®æ”¹å‰**ï¼š
```html
<button id="openSplitView">ğŸŒ åˆ†å±è§†å›¾ (æ¨è) âœ¨</button>
```

**ä¿®æ”¹å**ï¼š
```html
<button id="openTabSelector">ğŸŒ ä»æ ‡ç­¾é¡µé€‰æ‹©å¹¶åˆ†å± (æ¨è) âœ¨</button>
```

#### `popup/popup.js`
**ä¿®æ”¹**ï¼š
- âœ… æ·»åŠ `openTabSelector`äº‹ä»¶ç›‘å¬å™¨
- âœ… æ‰“å¼€`tab-selector/tab-selector.html`

## ğŸ†• æ–°å¢æ–‡ä»¶

### 1. æ ‡ç­¾é¡µé€‰æ‹©å™¨

#### `tab-selector/tab-selector.html`
**åŠŸèƒ½**ï¼š
- æ˜¾ç¤ºæ‰€æœ‰å·²æ‰“å¼€çš„æ ‡ç­¾é¡µ
- æ”¯æŒå¤šé€‰ï¼ˆæœ€å¤š4ä¸ªï¼‰
- æä¾›åˆ·æ–°ã€å…¨é€‰ã€æ¸…é™¤åŠŸèƒ½
- å¯åŠ¨åˆ†å±æŒ‰é’®

**ç‰¹ç‚¹**ï¼š
- ç®€æ´ç¾è§‚çš„å¡ç‰‡å¼å¸ƒå±€
- å®æ—¶è®¡æ•°å™¨
- ç©ºçŠ¶æ€æç¤º
- ä½¿ç”¨æç¤º

#### `tab-selector/tab-selector.css`
**æ ·å¼ç‰¹ç‚¹**ï¼š
- æ¸å˜ç´«è‰²ä¸»é¢˜
- å“åº”å¼ç½‘æ ¼å¸ƒå±€
- å¹³æ»‘åŠ¨ç”»æ•ˆæœ
- å¡ç‰‡hoveræ•ˆæœ

#### `tab-selector/tab-selector.js`
**æ ¸å¿ƒåŠŸèƒ½**ï¼š

1. **åŠ è½½æ ‡ç­¾é¡µ**ï¼š
```javascript
async function loadTabs() {
  const tabs = await chrome.tabs.query({});
  allTabs = tabs.filter(tab => 
    tab.url && 
    (tab.url.startsWith('http://') || tab.url.startsWith('https://')) &&
    !tab.url.includes('chrome://') &&
    !tab.url.includes('chrome-extension://')
  );
  renderTabs();
}
```

2. **é€‰æ‹©/å–æ¶ˆé€‰æ‹©**ï¼š
```javascript
function toggleTab(tab, card) {
  if (selectedTabs.includes(tab)) {
    selectedTabs = selectedTabs.filter(t => t !== tab);
    card.classList.remove('selected');
  } else {
    if (selectedTabs.length >= MAX_SELECTION) {
      showNotification(`æœ€å¤šåªèƒ½é€‰æ‹© ${MAX_SELECTION} ä¸ªç½‘ç«™`, 'warning');
      return;
    }
    selectedTabs.push(tab);
    card.classList.add('selected');
  }
}
```

3. **å¯åŠ¨åˆ†å±**ï¼š
```javascript
async function startSplitView() {
  const sites = selectedTabs.map(tab => ({
    id: url.hostname.replace(/[^a-zA-Z0-9]/g, '_'),
    name: tab.title || url.hostname,
    url: tab.url,
    hostname: url.hostname,
    enabled: true
  }));
  
  await chrome.storage.local.set({ 
    selectedSitesForSplit: sites,
    splitViewTimestamp: Date.now()
  });
  
  chrome.tabs.create({ 
    url: chrome.runtime.getURL('split-view/split-view.html')
  });
}
```

## ğŸ”„ å·¥ä½œæµç¨‹

### æ–°çš„ç”¨æˆ·æµç¨‹ï¼š

1. **ç”¨æˆ·æ‰“å¼€æƒ³è¦åˆ†å±çš„ç½‘ç«™**
   - åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ChatGPTã€Geminiã€Claudeç­‰

2. **ç‚¹å‡»æ‰©å±•å›¾æ ‡ â†’ "ä»æ ‡ç­¾é¡µé€‰æ‹©å¹¶åˆ†å±"**
   - æ‰“å¼€`tab-selector`é¡µé¢

3. **åœ¨æ ‡ç­¾é¡µé€‰æ‹©å™¨ä¸­**
   - çœ‹åˆ°æ‰€æœ‰å·²æ‰“å¼€çš„ç½‘ç«™ï¼ˆå¸¦faviconå’Œæ ‡é¢˜ï¼‰
   - å‹¾é€‰æƒ³è¦åˆ†å±çš„ç½‘ç«™ï¼ˆæœ€å¤š4ä¸ªï¼‰
   - å¯ä»¥ä½¿ç”¨"å…¨é€‰"ã€"æ¸…é™¤"ã€"åˆ·æ–°"ç­‰åŠŸèƒ½

4. **ç‚¹å‡»"å¼€å§‹åˆ†å±"**
   - æ•°æ®ä¸´æ—¶ä¿å­˜åˆ°`chrome.storage.local`
   - æ‰“å¼€`split-view.html`
   - `split-view`è¯»å–ä¸´æ—¶æ•°æ®å¹¶åŠ è½½ç½‘ç«™

5. **åˆ†å±é¡µé¢æ˜¾ç¤ºé€‰ä¸­çš„ç½‘ç«™**
   - å®Œå…¨åŠ¨æ€ï¼Œæ²¡æœ‰ä»»ä½•ç¡¬ç¼–ç 
   - æ”¯æŒ2/3/4ä¸ªç½‘ç«™çš„ä¸åŒå¸ƒå±€

## ğŸ“Š æ•°æ®æµ

```
ç”¨æˆ·æ‰“å¼€ç½‘ç«™
    â†“
chrome.tabs.query() è·å–æ‰€æœ‰æ ‡ç­¾é¡µ
    â†“
tab-selector æ˜¾ç¤ºåˆ—è¡¨
    â†“
ç”¨æˆ·é€‰æ‹©ç½‘ç«™
    â†“
chrome.storage.local.set({
  selectedSitesForSplit: [...],
  splitViewTimestamp: Date.now()
})
    â†“
æ‰“å¼€ split-view.html
    â†“
split-view è¯»å– storage.local
    â†“
æ£€æŸ¥æ—¶é—´æˆ³ï¼ˆ5ç§’å†…æœ‰æ•ˆï¼‰
    â†“
åŠ è½½é€‰ä¸­çš„ç½‘ç«™åˆ°iframe
    â†“
æ¸…é™¤ä¸´æ—¶æ•°æ®
```

## âœ… å®Œå…¨ç§»é™¤ç¡¬ç¼–ç çš„å¥½å¤„

1. **å®Œå…¨çµæ´»**
   - ç”¨æˆ·å¯ä»¥é€‰æ‹©ä»»ä½•ç½‘ç«™ï¼Œä¸é™äºAI
   - æ”¯æŒå°ä¼—AIã€ä¼ä¸šå†…éƒ¨å·¥å…·ç­‰

2. **é›¶ç»´æŠ¤**
   - ä¸éœ€è¦é¢„è®¾ç½‘ç«™åˆ—è¡¨
   - ä¸éœ€è¦ä¸ºæ–°AIæ·»åŠ ä»£ç 

3. **ç”¨æˆ·å‹å¥½**
   - å¯è§†åŒ–é€‰æ‹©ï¼Œæ¸…æ™°ç›´è§‚
   - å®æ—¶æ˜¾ç¤ºfaviconå’Œæ ‡é¢˜
   - æ”¯æŒåˆ·æ–°å’Œé‡æ–°é€‰æ‹©

4. **æŠ€æœ¯ä¼˜é›…**
   - ä½¿ç”¨æ ‡å‡†Chrome API
   - æ•°æ®æµæ¸…æ™°
   - æ—¶é—´æˆ³éªŒè¯é˜²æ­¢æ•°æ®æ±¡æŸ“

## ğŸ§ª æµ‹è¯•æ¸…å•

- [ ] `config.js` ä¸­ `DEFAULT_AI_SITES` ä¸ºç©ºæ•°ç»„
- [ ] `split-view.js` ä¸­ `getDefaultSites()` è¿”å›ç©ºæ•°ç»„
- [ ] `content-scripts/injector.js` ä¸­ `getDefaultSites()` è¿”å›ç©ºæ•°ç»„
- [ ] `main/main.js` ä¸­ä¸å†ä½¿ç”¨ `DEFAULT_AI_SITES`
- [ ] popupä¸­ä¸»æŒ‰é’®æ”¹ä¸º"ä»æ ‡ç­¾é¡µé€‰æ‹©å¹¶åˆ†å±"
- [ ] ç‚¹å‡»ä¸»æŒ‰é’®æ‰“å¼€`tab-selector`é¡µé¢
- [ ] `tab-selector`æ­£ç¡®æ˜¾ç¤ºæ‰€æœ‰æ ‡ç­¾é¡µ
- [ ] å¯ä»¥é€‰æ‹©å¤šä¸ªæ ‡ç­¾é¡µï¼ˆæœ€å¤š4ä¸ªï¼‰
- [ ] ç‚¹å‡»"å¼€å§‹åˆ†å±"åæ­£ç¡®è·³è½¬å¹¶åŠ è½½
- [ ] `split-view`æ­£ç¡®æ˜¾ç¤ºé€‰ä¸­çš„ç½‘ç«™

## ğŸ‰ æ€»ç»“

é€šè¿‡è¿™æ¬¡å…¨é¢æ”¹é€ ï¼Œæ’ä»¶å·²ç»ï¼š
- âœ… **å®Œå…¨ç§»é™¤äº†æ‰€æœ‰ç¡¬ç¼–ç **
- âœ… **å®ç°äº†çœŸæ­£çš„åŠ¨æ€é€‰æ‹©**
- âœ… **æä¾›äº†æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ**
- âœ… **ä½¿æ’ä»¶æ›´åŠ é€šç”¨å’Œçµæ´»**

ç°åœ¨ç”¨æˆ·å¯ä»¥å°†**ä»»ä½•ç½‘ç«™**è¿›è¡Œåˆ†å±æ˜¾ç¤ºï¼Œä¸ä»…ä»…æ˜¯AIèŠå¤©ç½‘ç«™ï¼

